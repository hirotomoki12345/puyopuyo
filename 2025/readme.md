『ぷよぷよ』ゲーム設計詳細（完全版）
1. 概要
本ゲームは HTML5 Canvas を使用して『ぷよぷよ』風の落ちものパズルを実装する。
ゲームは index.html, config.js, game.js の3つのファイルに分割し、設定・描画・ロジックを管理する。

2. ファイル構成
bash
コピーする
編集する
/puyo_game/
  ├── index.html      # 画面描画・Canvas設定
  ├── config.js       # ゲーム設定（速度・ボーナス値など）
  ├── game.js         # ゲームロジック・描画処理
  ├── assets/         # 画像やサウンド素材
  │   ├── img/        # ぷよの画像
  │   ├── ui/         # UI画像（背景、スコアボードなど）
  │   ├── sound/      # 効果音（連鎖音など）
3. 画面レイアウト
ゲーム画面は Canvas を使用し、以下のようなレイアウトとする。

diff
コピーする
編集する
+--------------------------------------+
|          Nextぷよ表示（右上）        |
+--------------------------------------+
|            ゲームフィールド            |
|        (12×6のグリッド)               |
+--------------------------------------+
|            スコア表示（下）            |
+--------------------------------------+
3.1 Nextぷよ表示
画面 右上 に NEXT ぷよを表示。
3.2 ゲームフィールド
フィールドは 縦12×横6マス の 固定グリッド。
1マスごとのサイズを決め、ぷよをマス単位で描画。
3.3 スコア表示
画面 下部 にスコア（得点・連鎖数）を表示。
4. ゲームの流れ
ぷよを生成

NEXT ぷよを 現在のぷよ にセットし、新たな NEXT をランダム生成。
プレイヤー操作

移動（←→キー）
回転（Z/Xキー）
落下（↓キー）
ぷよの接着

ぷよが 床または他のぷよ に接触すると固定。
消去判定

4つ以上同じ色 が 上下左右に接続 すると消滅。
連鎖処理

連鎖が続く限り 落下・消去を繰り返す。
ゲームオーバー判定

ぷよが 13段目を超えて積まれる と ゲームオーバー。
5. 操作仕様
5.1 キー操作
操作	キー
左移動	←
右移動	→
ソフトドロップ	↓
ハードドロップ	SPACE
左回転	Z
右回転	X
5.2 回転時の制約
壁ずらし回転 を試みる（1マス横にずらして回転）。
それでも回転できない場合は 回転不可。
5.3 固定猶予
ぷよが接地しても、30フレーム（0.5秒） は操作可能。
6. ぷよの消去とスコア
6.1 消去条件
ぷよが 4つ以上 繋がると消える。
上のぷよが落ちて 新たに4つ以上繋がると 連鎖発生。
6.2 スコア計算
scss
コピーする
編集する
消したぷよの数 × (連鎖ボーナス + 連結ボーナス + 色数ボーナス) × 10
連鎖ボーナス
連鎖数	ボーナス
1連鎖	0
2連鎖	8
3連鎖	16
連結ボーナス
ぷよ数	ボーナス
4個	0
5個	2
色数ボーナス
色数	ボーナス
1色	0
2色	3
7. 設定ファイル（config.js）
js
コピーする
編集する
const config = {
  fallSpeed: 1,          // 落下速度
  lockDelay: 30,         // 固定までの猶予時間
  raiseLimitPerTurn: 6,  // 回転で持ち上げ可能な回数
  rotateBufferTime: 30,  // 0.5秒以内に2回回転で180度回転
};
8. 画像管理
8.1 画像ファイルのパス
bash
コピーする
編集する
img/{色}/image_({色番号}-{アセット番号}).png
8.2 色番号
色	番号
赤	1
緑	2
青	3
黄	4
紫	5
8.3 アセット番号
番号	連結方向
1	通常（連結なし）
2	下のみ
3	上のみ
4	上下
5	右のみ
6	右下
7	右上
8	上下右
9	左のみ
10	左下
11	左上
12	上下左
13	左右
14	左右下
15	左右上
16	左右上下
9. まとめ
この設計を基に HTML5 Canvas でぷよぷよゲームを実装する。
次のステップは index.html, config.js, game.js のコーディング。
